"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[70672],{81542:function(e,t,r){r.d(t,{Z:function(){return s},p:function(){return i}});var n=r(51438),o=r(52951),a=r(62011),i={CHANNEL_MANAGER:"manager",MODERATOR:"moderator",EDITOR:"editor",TRANSLATION_EDITOR:"translation_editor",SEGMENTER:"segmenter",SUBTITLER:"subtitler"},s=function(){function e(t){(0,n.Z)(this,e),this.id=t.id,this.languageCode=t.languageCode,this.role=t.role,this.user=t.user}return(0,o.Z)(e,null,[{key:"fromApiData",value:function(t){return t&&t.id?new e({id:t.id,languageCode:null!==(r=t.language_code)&&void 0!==r?r:null,role:null!==(n=t.role)&&void 0!==n?n:null,user:t.user?a.Z.fromApiData(t.user):null}):null;var r,n}},{key:"fromApiDataList",value:function(t){return t?t.map((function(t){return e.fromApiData(t)})):null}}]),e}()},22748:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(51438),o=r(29237),a=function(){function e(t){(0,n.Z)(this,e),this.type=t.type,this.source=t.source,this.language=t.language,this.titles=t.titles,this.thumbnail=t.thumbnail,this.webUrl=t.webUrl,this.publishedAt=t.publishedAt}return e.prototype.localisedTitle=function(){return(0,o.Z5)(this.titles)},e.fromApiData=function(t){var r,n,o;return new e({type:t.type,source:t.source,language:t.language,titles:null!==(o=t.titles)&&void 0!==o?o:{},thumbnail:null===(r=t.images)||void 0===r?void 0:r.thumbnail,webUrl:null===(n=t.url)||void 0===n?void 0:n.web,publishedAt:t.published_at?new Date(t.published_at):void 0})},e.fromApiDataList=function(t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value,u=e.fromApiData(c);if(!u)return null;r.push(u)}}catch(l){o=!0,a=l}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r},e}()},70672:function(e,t,r){r.d(t,{Z:function(){return x}});var n=r(47568),o=r(51438),a=r(26042),i=r(69396),s=r(10092),c=r(33092),u=r(11118),l=r(79668),d=r(89716),p=r(11466),g=r(29237),h=r(37493),m=r(81542),v=r(22748),f=r(62011),y=r(8615),Z=r(75688),w=r(40781),_=r(2014),b="ContainerRepositoryError_getSynopsis",E="ContainerRepositoryError_getSeoDescriptions",C="ContainerRepositoryError_getCastsJson",N="ContainerRepositoryError_getNews",R="ContainerRepositoryError_getVideos",I="ContainerRepositoryError_getRelatedVideos",A="ContainerRepositoryError_getVideoIds",T="ContainerRepositoryError_getCurrentUserRole",k="ContainerRepositoryError_getAllContributorsWithRole",D="ContainerRepositoryError_getContributors",S={direction:"asc",with_upcoming:"true",sort:"number",blocked:"true"},x=function(){function e(){(0,o.Z)(this,e)}return e.getContainers=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.contentType,o=t.verticalContent,l=t.hasPaywallContent,g=t.exclusive,m=t.sortBy,v=t.page,f=void 0===v?1:v,y=t.perPage,_=void 0===y?20:y,b=t.withPaging,E=void 0!==b&&b,C=t.canEnableTvod,N=void 0!==C&&C,R=t.countryOriginCode,I=t.genreId,A=t.order,T=void 0===A?"desc":A,k=t.token,D=t.licensed,S=void 0===D||D,x=t.cacheBustMode,H=void 0===x?u.D.None:x,P=t.privilegesHash,j=t.req,F=void 0===j?null:j;return(0,n.Z)((function(){var t,n,v,y,b,C,A,D,x,j;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:t="containers.json",n=(0,i.Z)((0,a.Z)({page:f,per_page:_,with_paging:E.toString(),direction:T},r&&{type:r},o&&{vertical_content:o},void 0!==l&&{has_paywall_content:l.toString()},g&&{exclusive:"true"},m&&{sort:m},R&&{origin_country:R},I&&{genre:I},k&&{token:k}),{licensed:S?"true":"false"}),N&&(n=p.z.addTvodParameter(t,n)),n=(0,u.F)(n,H,{privilegesHash:P}),v={component:e.displayName,action:"getContainers",context:{page:f,verticalContent:o,contentType:r,sortBy:m,perPage:_,canEnableTvod:N}},y=null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,c.hi.send(t,{params:n},F)];case 2:return y=s.sent(),[3,4];case 3:throw b=s.sent(),C=w.Z.getCommonError(b),d.Z.log((0,a.Z)({error:C},v)),new Error(C);case 4:if(!(A=null===y||void 0===y?void 0:y.response))throw D=new Error(Z.H.MalformedPayload),d.Z.log((0,a.Z)({error:D},v)),D;if(!(x=h.ZP.fromApiDataList(A)))throw j=new Error(Z.H.MalformedPayload),d.Z.log((0,a.Z)({error:j},v)),j;return[2,{containers:x,containersApiData:A,hasMore:y.more||!1}]}}))}))()},e.getContainerJson=function(t,r,o){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.Z)((function(){var n,u,l,p;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:n=(0,c.CQ)(r),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,c.hi.getContainer(t).get((0,c.zG)({headers:n,params:(0,a.Z)({token:o},i&&{t:Math.floor((new Date).getTime()/1e3)})},r))];case 2:return[2,s.sent()];case 3:throw u=s.sent(),404===(p=u).status&&404===(null===(l=p.body)||void 0===l?void 0:l.vcode)||d.Z.log({error:p,component:e.displayName,action:"getContainerJson",context:{containerId:t,headers:n}}),p;case 4:return[2]}}))}))()},e.getContainer=function(t,r,o){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,n.Z)((function(){var n,u;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,c.hi.getContainer(t).get((0,c.zG)({params:(0,a.Z)({token:o},i&&{t:Math.floor((new Date).getTime()/1e3)})},r))];case 1:return n=s.sent(),[2,h.ZP.fromApiData(n)];case 2:throw u=s.sent(),d.Z.log({error:u,component:e.displayName,action:"getContainer",context:{containerId:t}}),u;case 3:return[2]}}))}))()},e.getCastsJson=function(t,r,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;return(0,n.Z)((function(){var n,i;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:n=(0,c.CQ)(o),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,c.hi.send("containers/".concat(t,"/people-involved/").concat(r,".json"),{headers:n,params:{per_page:a}},o)];case 2:return[2,s.sent().response];case 3:throw i=s.sent(),d.Z.log({error:i,component:e.displayName,action:"getCastsJson",context:{containerId:t,language:r}}),new Error(C);case 4:return[2]}}))}))()},e.getSynopsis=function(t,r){return(0,n.Z)((function(){var n,o,a;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,c.hi.send("containers/".concat(t,"/descriptions/").concat(r,".json"),{params:{html:"true"}})];case 1:return n=i.sent().description,[2,(0,g.Z5)(null===n||void 0===n?void 0:n.viki)];case 2:throw o=i.sent(),a=w.Z.getErrorFromStatus(null===o||void 0===o?void 0:o.status),w.Z.isClientError(o)||a===Z.H.NotFound||d.Z.log({error:o,component:e.displayName,action:"getSynopsis",context:{containerId:t,language:r}}),new Error(b);case 3:return[2]}}))}))()},e.getNews=function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return(0,n.Z)((function(){var n,a,i,u,l,p,g,h;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,c.hi.send("containers/".concat(t,"/related_news.json"),{params:{src:"soompi",language:r,page:1,per_page:o}})];case 1:return i=s.sent().response,l=null!==(u=null===(n=i.more_stories)||void 0===n||null===(a=n.url)||void 0===a?void 0:a.web)&&void 0!==u?u:null,p=v.Z.fromApiDataList(i.news_items),[2,{soompiLink:l,newsList:p}];case 2:throw g=s.sent(),h=w.Z.getErrorFromStatus(null===g||void 0===g?void 0:g.status),w.Z.isClientError(g)||h===Z.H.NotFound||d.Z.log({error:g,component:e.displayName,action:"getNews",context:{containerId:t,language:r}}),new Error(N);case 3:return[2]}}))}))()},e.getCommunityCover=function(t,r){return(0,n.Z)((function(){var n,o,a,i,u;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,c.hi.send("containers/".concat(t,"/covers/").concat(r,".json"))];case 1:return n=s.sent(),[2,null!==(o=n.html)&&void 0!==o?o:""];case 2:throw a=s.sent(),i=w.Z.getCommonError(a),u=w.Z.getErrorFromStatus(null===a||void 0===a?void 0:a.status),w.Z.isClientError(a)||u===Z.H.NotFound||i===Z.H.NetworkError||i===Z.H.NotFound||d.Z.log({error:a,component:e.displayName,action:"getCommunityCover",context:{containerId:t,language:r,errorType:i}}),new Error(i);case 3:return[2]}}))}))()},e.getVideos=function(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,n.Z)((function(){var n,i,u,p,g,m;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:n=r===h.lS.Movie?"movies":"episodes",i="containers/".concat(t,"/").concat(n,".json"),u=[],s.label=1;case 1:return s.trys.push([1,3,,4]),[4,c.hi.send(i,{method:"GET",params:(0,a.Z)({token:l.Z.userInfo().token},S,o)})];case 2:return p=s.sent(),g=p.response,u=(0,_.GW)(g),[3,4];case 3:throw m=s.sent(),w.Z.getCommonError(m)!==Z.H.NetworkError&&d.Z.log({error:m,component:e.displayName,action:"getVideos",context:{containerId:t,containerType:r,options:(0,a.Z)({url:i},o)}}),new Error(R);case 4:return[2,u]}}))}))()},e.getRelatedVideos=function(t){var r=t.containerId,o=t.videoType,a=t.page,i=void 0===a?1:a,u=t.perPage,p=void 0===u?20:u,g=t.req;return(0,n.Z)((function(){var t,n,a,u,h;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:t=(l.Z.userInfo(g)||{}).token,n={sort:"newest_video",per_page:p,page:i},t&&(n.token=t),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,c.hi.send("containers/".concat(r,"/").concat(o,"s.json"),{params:n},g)];case 2:return a=s.sent(),[2,{videos:y.C.fromApiDataList(a.response)||[],more:a.more}];case 3:throw u=s.sent(),h=w.Z.getErrorFromStatus(null===u||void 0===u?void 0:u.status),w.Z.isClientError(u)||h===Z.H.NotFound||d.Z.log({error:u,component:e.displayName,action:"getRelatedVideos",context:{containerId:r,videoType:o,page:i,perPage:p}}),new Error(I);case 4:return[2]}}))}))()},e.getVideoIds=function(t,r,o,u){return(0,n.Z)((function(){var n,p,g,h;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:n="containers/".concat(t,"/").concat(r,"s.json"),p=[],s.label=1;case 1:return s.trys.push([1,3,,4]),[4,c.hi.send(n,{method:"GET",params:(0,i.Z)((0,a.Z)({token:l.Z.userInfo(u).token},S,o),{only_ids:"true"})})];case 2:return g=s.sent().response,p=g,[3,4];case 3:throw h=s.sent(),w.Z.getCommonError(h)!==Z.H.NetworkError&&d.Z.log({error:h,component:e.displayName,action:"getVideoIds",context:{containerId:t,options:(0,i.Z)((0,a.Z)({url:n},o),{only_ids:"true"})}}),new Error(A);case 4:return[2,p]}}))}))()},e.getAllContributorsWithRole=function(t){return(0,n.Z)((function(){var r,n,o;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:r={method:"GET",url:"/api/containers/".concat(t,"/contributors")},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(0,c.So)(r)];case 2:return n=a.sent().data,[2,Object.values(m.p).reduce((function(e,t){return e["".concat(t,"s")]=m.Z.fromApiDataList(null===n||void 0===n?void 0:n["".concat(t,"s")]),e}),{})];case 3:throw o=a.sent(),d.Z.log({error:o,component:e.displayName,action:"getAllContributorsWithRole",context:{containerId:t}}),new Error(k);case 4:return[2]}}))}))()},e.getCurrentUserRole=function(t){return(0,n.Z)((function(){var r,n,o;return(0,s.__generator)(this,(function(a){switch(a.label){case 0:if(!(r=l.Z.userInfo()).id)return[2,null];n={method:"GET",url:"/api/containers/".concat(t,"/contributors"),params:{userId:r.id}},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(0,c.So)(n)];case 2:return[2,a.sent().data.map((function(e){return e.role}))];case 3:throw o=a.sent(),d.Z.log({error:o,component:e.displayName,action:"getCurrentUserRole",context:{containerId:t}}),new Error(T);case 4:return[2]}}))}))()},e.getContributors=function(t,r,o){return(0,n.Z)((function(){var n,i,u,l,p;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:n={method:"GET",url:"/api/containers/".concat(t,"/contributors"),params:(0,a.Z)({role:r},o)},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,(0,c.So)(n)];case 2:return i=s.sent().data,u=i.response,l=i.more,[2,{contributors:f.Z.fromApiDataList(u),more:l}];case 3:throw p=s.sent(),d.Z.log({error:p,component:e.displayName,action:"getContributors",context:{containerId:t,options:(0,a.Z)({role:r},o)}}),new Error(D);case 4:return[2]}}))}))()},e.getWatchScheduleParams=function(e){return e?{watch_schedule:1,ws_end_time:Math.round(new Date(e).getTime()/1e3)}:{}},e.getSeoDescriptions=function(t,r){return(0,n.Z)((function(){var n,o,a,i;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,c.hi.send("containers/".concat(t,"/seo_descriptions.json"),{params:{html:"false"}},r)];case 1:if(!(null===(n=s.sent().seo_description)||void 0===n?void 0:n.viki))return[2,null];for(var u in o=n.viki)Object.prototype.hasOwnProperty.call(o,u)&&!o[u]&&delete o[u];return[2,Object.keys(o).length?o:null];case 2:throw a=s.sent(),i=w.Z.getErrorFromStatus(null===a||void 0===a?void 0:a.status),w.Z.isClientError(a)||i===Z.H.NotFound||d.Z.log({error:a,component:e.displayName,action:"getSeoDescriptions",context:{containerId:t}}),new Error(E);case 3:return[2]}}))}))()},e}();x.displayName="ContainerRepository"}}]);
//# sourceMappingURL=70672-f38b943d519c3c86.js.map